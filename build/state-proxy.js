!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.StateProxy=t():e.StateProxy=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e,t){var n={};return"undefined"==typeof t.getState&&(n.state=e.getDefaultState(),t.getState=function(){return n.state}),"undefined"==typeof t.setState&&(t.setState=function(e){n.state=e}),e}function r(e,t,n){var r={schemaNode:e,getState:t,setState:n},i=o(r);return a(i,r)}var o=n(2);e.exports={create:r,SchemaTypes:n(3)}},function(e,t){function n(e,t){e.getState=function(e,n){var a=t.getState(),r=Object.assign({},a);return"undefined"!=typeof n&&Object.assign(r,n,{val:a.val}),"undefined"!=typeof e&&"undefined"==typeof t.schemaNode.val&&Object.assign(r,{val:e}),r},e.getDefaultState=function(){return{val:t.schemaNode["default"]}},e.val=function(n,a){if("undefined"!=typeof t.schemaNode.val)return"undefined"!=typeof n&&console.log("WARNING: Setting operation for calculated property is not allowed"),t.schemaNode.val(t.getState);if("undefined"==typeof n)return t.getState().val;var r=e.getState(n);a||(r.hasChanges=!0),t.setState(r)},e.ignored=function(){var e=t.schemaNode.ignored;if("undefined"==typeof e)return!1;if("boolean"==typeof e)return e;if("function"==typeof e)return e(t.getState);throw new Error('"ignored" definition is invalid')},e.required=function(){var n=t.schemaNode.required;if("undefined"==typeof n||e.ignored())return!1;if("boolean"==typeof n)return n;if("function"==typeof n)return n(t.getState);throw new Error('"required" definition is invalid')},e.validate=function(n){var a={isValid:!0,validationMessage:""};if(e.ignored())return a;var r=e.val(),o=e.getState(),i="undefined"==typeof r||null===r||""===r;if((o.hasChanges||n)&&i&&e.required())a.isValid=!1,a.validationMessage="Required field";else{var u=t.schemaNode.validate;if("function"==typeof u){var f=u(t.getState);"boolean"==typeof f?a.isValid=f:a=f}}return a},e.exposeRequiredErrors=function(){var n=e.getState(void 0,{hasChanges:!0});t.setState(n)},e.resetToDefault=function(){var n=e.getDefaultState();t.setState(n)}}e.exports=n},function(e,t,n){function a(e){var t=n(4),a=Object.create(null);if(!t.hasOwnProperty(e.schemaNode.type))throw new Error("ERROR: StateProxy encountered unrecognized schema type: "+e.schemaNode.type);var r=t[e.schemaNode.type];return a=r(e),a.schema=e.schemaNode,a}e.exports=a},function(e,t){e.exports={dynamic:void 0,bool:"bool",number:"number",string:"string",object:"object",list:"list"}},function(e,t,n){var a=n(3),r={};r[a.dynamic]=n(8),r[a.bool]=n(7),r[a.number]=n(9),r[a.string]=n(10),r[a.object]=n(6),r[a.list]=n(5),e.exports=r},function(e,t,n){function a(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}function r(e,t){var n=Object.create(null),r=e.schemaNode.idPropertyName||"id",o=t[r].val;return n.schemaNode=e.schemaNode.listItem,n.getState=function(){var t=e.getState();return a(t.val,function(e){return e.val[r].val==o})},n.getState.getParentState=e.getState,n.setState=function(t){var n=e.getState(),a=n.val.map(function(e){return e.val[r].val===o?t:e});return n.val=a,e.setState(n)},i(n)}function o(e){var t=Object.create(null),n=e.schemaNode.idPropertyName||"id";return t.getItems=function(t,n){var a=e.getState(),o=a.val.map(function(t){return r(e,t.val)});return o},t.getDefaultState=function(){return{val:[]}},t.getState=function(){return e.getState()},t.val=function(o){if("undefined"==typeof o)return t.getItems().map(function(e){return e.val()});var i=t.getItems(),u=o.map(function(t){var o=a(i,function(e){return e.getState()[n]===t[n]});return"undefined"==typeof o&&(o=r(e,t)),o.getState(t)});e.setState({val:u})},t.addItem=function(t){var n=e.getState(),a=r(e,t),o=a.getState(t);n.val.push(o),e.setState(n)},t.validate=function(){},t}var i=n(2);e.exports=o},function(e,t,n){function a(e,t){var n=Object.create(null);return n.schemaNode=t.schemaNode.properties[e],n.getState=function(){var n=t.getState()||{val:{}};return n.val[e]},n.getState.getParentState=t.getState,n.setState=function(n){var a=t.getState();return a.val[e]=n,t.setState(a)},n}function r(e,t){for(var n=Object.create(null),r=0;r<e.length;r++){var o=e[r],u=a(o,t);n[o]=i(u)}return n}function o(e){var t=Object.create(null),n=[];e.schemaNode.properties&&(n=Object.keys(e.schemaNode.properties));var a=null;return t.getProperties=function(){return a||(a=r(n,e)),a},t.getDefaultState=function(){for(var e={val:Object.create(null)},a=0;a<n.length;a++){var r=n[a];e.val[r]=t.getProperties()[r].getDefaultState()}return e},t.getState=function(a,r){var o=e.getState()||{val:{}},i=Object.assign({},o);if("undefined"!=typeof a||"undefined"!=typeof r){Object.assign(i,r,{val:o.val});for(var u=Object.create(null),f=0;f<n.length;f++){var c=n[f],s="undefined"!=typeof a?a[c]:void 0;u[c]=t.getProperties()[c].getState(s,r)}Object.assign(i,{val:u})}return i},t.val=function(a,r){if("undefined"!=typeof e.schemaNode.val)return"undefined"!=typeof a&&console.log("WARNING: Setting operation for calculated property is not allowed"),e.schemaNode.val(e.getState);if("undefined"==typeof a){for(var o=Object.create(null),i=0;i<n.length;i++){var u=n[i];o[u]=t.getProperties()[u].val()}return o}var f=t.getState(a);r||(f.hasChanges=!0),e.setState(f)},t.validate=function(e){for(var a={isValid:!0,validationMessage:""},r=0;r<n.length;r++){var o=n[r],i=t.getProperties()[o].validate(e).isValid;if(!i){a.isValid=!1;break}}return a},t.exposeRequiredErrors=function(){var n=t.getState(void 0,{hasChanges:!0});e.setState(n)},t.resetToDefault=function(){var n=t.getDefaultState();e.setState(n)},t}var i=n(2);e.exports=o},function(e,t,n){function a(e){var t=Object.create(null);return r(t,e),t}var r=n(1);e.exports=a},function(e,t,n){function a(e){var t=Object.create(null);return r(t,e),t}var r=n(1);e.exports=a},function(e,t,n){function a(e){var t=Object.create(null);return r(t,e),t}var r=n(1);e.exports=a},function(e,t,n){function a(e){var t=Object.create(null);return r(t,e),t}var r=n(1);e.exports=a}])});