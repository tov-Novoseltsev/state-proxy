!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StateProxy=e():t.StateProxy=e()}(this,function(){return function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var a=e.slice(1),n=t[e[0]];return function(t,e,r){n.apply(this,[t,e,r].concat(a))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,a){function n(t,e){var a={};return"undefined"==typeof e.getState&&(a.state=t.getDefaultState(),e.getState=function(){return a.state}),"undefined"==typeof e.setState&&(e.setState=function(t){a.state=t}),t}function r(t,e,a){var r={schemaNode:t,getState:e,setState:a},o=i.create(r);return o.getData=function(){return i.deconstructState(t,e)},o.setData=function(n){a(i.constructState(t,e(),n))},n(o,r)}function o(t,e){var a={isValid:t,validationMessage:""};return t||(a.validationMessage=e),a}var i=a(2);t.exports={create:r,formValidationResult:o,SchemaTypes:a(3)}},function(t,e){function a(t){return{val:t["default"]}}function n(t,e,n,r){var o=e||a(t),i=Object.assign({},o);return"undefined"!=typeof r&&Object.assign(i,r,{val:o.val}),"undefined"!=typeof n&&Object.assign(i,{val:n}),i}function r(t,e){var a;return a="undefined"==typeof t.val?e().val:"function"==typeof t.val?t.val(e):t.val,"function"==typeof t.getDataTransform&&(a=t.getDataTransform(a)),a}function o(t){var e=Object.create(null);return e.getDefaultState=a.bind(null,t.schemaNode),e.getState=function(e,a){var r=t.getState();return n(t.schemaNode,r,e,a)},e.val=function(a){if("undefined"==typeof a)return"undefined"!=typeof t.schemaNode.val?t.schemaNode.val(t.getState):t.getState().val;var n=e.getState(a);n.hasChanges=!0,t.setState(n)},e.ignored=function(){var e=t.schemaNode.ignored;if("undefined"==typeof e)return!1;if("boolean"==typeof e)return e;if("function"==typeof e)return e(t.getState);throw new Error('"ignored" definition is invalid')},e.required=function(){var a=t.schemaNode.required;if("undefined"==typeof a||e.ignored())return!1;if("boolean"==typeof a)return a;if("function"==typeof a)return a(t.getState);throw new Error('"required" definition is invalid')},e.validate=function(a){var n={isValid:!0,validationMessage:""},r=e.getState(),o=r.hasChanges||a;if(!o||e.ignored())return n;var i=e.val(),u="undefined"==typeof i||null===i||""===i||i===[];if(u&&e.required())n.isValid=!1,n.validationMessage="Required field";else{var c=t.schemaNode.validate;if("function"==typeof c){var f=c(t.getState);"boolean"==typeof f?n.isValid=f:n=f}}return n},e.exposeRequiredErrors=function(){var a=e.getState(void 0,{hasChanges:!0});t.setState(a)},e.resetToDefault=function(){var a=e.getDefaultState();t.setState(a)},e}t.exports={getDefaultState:a,constructState:n,deconstructState:r,create:o}},function(t,e,a){function n(t){var e=a(4);if(e.hasOwnProperty(t.type)){var n=e[t.type];return n}throw new Error("ERROR: StateProxy encountered unrecognized schema type: "+t.type)}function r(t){var e=n(t.schemaNode),a=e.create(t);return a.schema=t.schemaNode,a}function o(t){var e=n(t);return e.getDefaultState(t)}function i(t,e,a,r){var o=n(t);return o.constructState(t,e,a,r)}function u(t,e){var a=n(t);return a.deconstructState(t,e)}t.exports={create:r,getDefaultState:o,constructState:i,deconstructState:u}},function(t,e){t.exports={dynamic:void 0,bool:"bool",number:"number",string:"string",object:"object",list:"list"}},function(t,e,a){var n=a(3),r={};r[n.dynamic]=a(1),r[n.bool]=a(7),r[n.number]=a(8),r[n.string]=a(9),r[n.object]=a(6),r[n.list]=a(5),t.exports=r},function(t,e,a){function n(t,e){for(var a=0;a<t.length;a++)if(e(t[a]))return t[a]}function r(t){return{val:t["default"]||[]}}function o(t,e,a,n){var o=Object.assign({},e||r(t));if("undefined"!=typeof a){var i=a;"function"==typeof t.setDataTransform&&(i=t.setDataTransform(a));var u=i.map(function(e){return f.constructState(t.listItem,void 0,e,n)});Object.assign(o,{val:u})}else if("undefined"!=typeof n){var c=o.val.map(function(e){return f.constructState(t.listItem,e,void 0,n)});Object.assign(o,{val:c})}return o}function i(t,e){var a=e().val.map(function(a){var n=function(){return a};return n.getParentState=e,f.deconstructState(t.listItem,n)});return"function"==typeof t.getDataTransform&&(a=t.getDataTransform(a)),a}function u(t,e){var a=Object.create(null),r=t.schemaNode.idPropertyName||"id",o=e.val[r];return a.schemaNode=t.schemaNode.listItem,a.getState=function(){var e=t.getState();return n(e.val,function(t){return t.val[r]==o})},a.getState.getParentState=t.getState,a.setState=function(e){var a=t.getState(),n=a.val.map(function(t){return t.val[r].val===o?e:t});return a.val=n,t.setState(a)},f.create(a)}function c(t){var e=Object.create(null);return e.getItems=function(e,a){var n=t.getState(),r=n.val.map(function(e){return u(t,e)});return r},e.getDefaultState=r.bind(null,t.schemaNode),e.getState=function(e,a){var n=t.getState();return o(t.schemaNode,n,e,a)},e.val=function(a){if("undefined"==typeof a){var n=e.getState().val;return n.map(function(t){return t.val})}var r=a.map(function(e){var a=null;return f.constructState(t.schemaNode.listItem,a,e)});t.setState({val:r})},e.addItem=function(e){var a=t.getState(),n=u(t,e),r=n.getState(e);a.val.push(r),t.setState(a)},e.validate=function(t){for(var a={isValid:!0,validationMessage:""},n=e.getItems(),r=0;r<n.length;r++){var o=n[r].validate(t);if(!o.isValid){a.invalidPropertyIndex=r,a.invalidPropertyResult=o,a.isValid=!1;break}}return a},e}var f=a(2);t.exports={getDefaultState:r,constructState:o,deconstructState:i,create:c}},function(t,e,a){function n(t,e){var a=[];t&&(a=Object.keys(t));for(var n=0;n<a.length&&e(a[n],n)!==!0;n++);}function r(t){var e={val:Object.create(null)};return n(t.properties,function(a){var n=t.properties[a];e.val[a]=s.getDefaultState(n)}),e}function o(t,e,a,o){var i=e||r(t),u=Object.assign({},i);if("undefined"!=typeof a||"undefined"!=typeof o){var c=a;"function"==typeof t.setDataTransform&&"undefined"!=typeof a&&(c=t.setDataTransform(a)),Object.assign(u,o,{val:i.val});var f=Object.create(null);n(t.properties,function(e){var a="undefined"!=typeof c?c[e]:void 0,n=t.properties[e],r=i.val[e];f[e]=s.constructState(n,r,a,o)}),Object.assign(u,{val:f})}return u}function i(t,e){var a=Object.create(null);return n(t.properties,function(n){var r=t.properties[n],o=function(){return e().val[n]};o.getParentState=e,a[n]=s.deconstructState(r,o)}),"function"==typeof t.getDataTransform&&(a=t.getDataTransform(a)),a}function u(t,e){var a=Object.create(null);return a.schemaNode=e.schemaNode.properties[t],a.getState=function(){var a=e.getState()||{val:{}};return a.val[t]},a.getState.getParentState=e.getState,a.setState=function(a){var n=e.getState();return n.val[t]=a,e.setState(n)},a}function c(t){var e=Object.create(null);return n(t.schemaNode.properties,function(a){var n=u(a,t);e[a]=s.create(n)}),e}function f(t){var e=Object.create(null);return e.properties=c(t),e.getDefaultState=r.bind(null,t.schemaNode),e.getState=function(e,a){var n=t.getState();return o(t.schemaNode,n,e,a)},e.val=function(a){if("undefined"!=typeof t.schemaNode.val)return"undefined"!=typeof a&&console.log("WARNING: Setting operation for calculated property is not allowed"),t.schemaNode.val(t.getState);if("undefined"==typeof a){var r=Object.create(null);return n(t.schemaNode.properties,function(t){r[t]=e.properties[t].val()}),r}var o=e.getState(a);o.hasChanges=!0,t.setState(o)},e.validate=function(a){var r={isValid:!0,validationMessage:""};return n(t.schemaNode.properties,function(t){var n=e.properties[t].validate(a);if(!n.isValid)return r.invalidPropertyName=t,r.invalidPropertyResult=n,r.isValid=!1,!0}),r},e.exposeRequiredErrors=function(){var a=e.getState(void 0,{hasChanges:!0});t.setState(a)},e.resetToDefault=function(){var a=e.getDefaultState();t.setState(a)},e}var s=a(2);t.exports={getDefaultState:r,constructState:o,deconstructState:i,create:f}},function(t,e,a){var n=a(1);t.exports=n},7,7]))});